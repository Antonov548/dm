> flights_init <- dm_nycflights13() %>% dm_zoom_to(flights) %>% filter(FALSE) %>%
+   dm_update_zoomed() %>% dm_zoom_to(weather) %>% filter(FALSE) %>%
+   dm_update_zoomed()
> sqlite <- src_sqlite(":memory:", create = TRUE)
> flights_sqlite <- copy_dm_to(sqlite, flights_init, temporary = FALSE)
> print(dm_nrow(flights_sqlite))
  planes airlines airports  flights  weather 
    3322       16     1458        0        0 

> flights_jan <- dm_nycflights13() %>% dm_select_tbl(flights, weather) %>%
+   dm_zoom_to(flights) %>% filter(month == 1) %>% dm_update_zoomed() %>%
+   dm_zoom_to(weather) %>% filter(month == 1) %>% dm_update_zoomed()
> print(dm_nrow(flights_jan))
flights weather 
    932      72 

> flights_jan_sqlite <- copy_dm_to(sqlite, flights_jan, unique_table_names = TRUE)
> dm_insert(flights_sqlite, flights_jan_sqlite)
> print(dm_nrow(flights_sqlite))
  planes airlines airports  flights  weather 
    3322       16     1458      932       72 

> flights_feb <- dm_nycflights13() %>% dm_select_tbl(flights, weather) %>%
+   dm_zoom_to(flights) %>% filter(month == 2) %>% dm_update_zoomed() %>%
+   dm_zoom_to(weather) %>% filter(month == 2) %>% dm_update_zoomed()
> flights_feb_sqlite <- copy_dm_to(sqlite, flights_feb, unique_table_names = TRUE)
> flights_new <- dm_insert(flights_sqlite, flights_feb_sqlite, dry_run = TRUE)
> print(dm_nrow(flights_new))
  planes airlines airports  flights  weather 
    3322       16     1458     1761      144 

> print(dm_nrow(flights_sqlite))
  planes airlines airports  flights  weather 
    3322       16     1458      932       72 

> flights_new %>% dm_examine_constraints()
Message: ! Unsatisfied constraints:

* Table `flights`: foreign key tailnum into table `planes`: 273 entries (15.5%) of `flights$tailnum` not in `planes$tailnum`: N725MQ (6), N537MQ (5), N722MQ (5), N730MQ (5), N736MQ (5), ... (>= 7 total)

> dm_insert(flights_sqlite, flights_feb_sqlite)
> print(dm_nrow(flights_sqlite))
  planes airlines airports  flights  weather 
    3322       16     1458     1761      144 

