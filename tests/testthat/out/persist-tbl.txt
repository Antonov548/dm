> flights_init <- nycflights13::flights[0, ]
> sqlite <- src_sqlite(":memory:", create = TRUE)
> flights_sqlite <- copy_to(sqlite, flights_init, temporary = FALSE)
> print(count(flights_sqlite))
      n
  <int>
1     0

> flights_jan_1 <- nycflights13::flights %>% filter(month == 1, day == 1)
> print(count(flights_jan_1))
# A tibble: 1 x 1
      n
  <int>
1   842

> flights_jan_1_sqlite <- copy_to(sqlite, flights_jan_1)
> tbl_insert(flights_sqlite, flights_jan_1_sqlite)
Warning: Not persisting, use `persist = FALSE` to turn off this warning.

    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   <int> <int> <int>    <int>          <int>     <dbl>    <int>          <int>
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
# ... with more rows, and 11 more variables: arr_delay <dbl>, carrier <chr>,
#   flight <int>, tailnum <chr>, origin <chr>, dest <chr>, air_time <dbl>,
#   distance <dbl>, hour <dbl>, minute <dbl>, time_hour <dbl>

> print(count(flights_sqlite))
      n
  <int>
1     0

> tbl_insert(flights_sqlite, flights_jan_1_sqlite, persist = TRUE)
> print(count(flights_sqlite))
      n
  <int>
1   842

> flights_jan_2 <- nycflights13::flights %>% filter(month == 1, day == 2)
> flights_jan_2_sqlite <- copy_to(sqlite, flights_jan_2)
> flights_new <- tbl_insert(flights_sqlite, flights_jan_2_sqlite, persist = FALSE)
> print(count(flights_new))
      n
  <int>
1  1785

> print(count(flights_sqlite))
      n
  <int>
1   842

> flights_new %>% dplyr::count(year, month, day)
   year month   day     n
  <int> <int> <int> <int>
1  2013     1     1   842
2  2013     1     2   943

> tbl_insert(flights_sqlite, flights_jan_2_sqlite, persist = TRUE)
> print(count(flights_sqlite))
      n
  <int>
1  1785

