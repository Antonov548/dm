<!-- Generated by prepress, do not edit -->

# Building data models from data frames with dm

dm allows you to create your own relational data models from local data
frames. Once your data model is complete, you can deploy it a range of
DBMSs using dm.

## Creating a dm object from data frames

The example data set that we will be using is available through the
[`nycflights13`](https://github.com/hadley/nycflights13) package. The
five tables that we are working with contain information about all
flights that departed from the airports of New York to other
destinations in the United States in 2013:

  - `flights` represents the trips taken by planes
  - `airlines` includes
      - the names of transport organizations (`name`)
      - their abbreviated codes (`carrier`)
  - `airports` indicates the ports of departure (`origin`) and of
    destination (`dest`)
  - `weather` contains meteorological information at each hour
  - `planes` describes characteristics of the aircraft

Once we’ve loaded {nycflights13}, the aforementioned tables are all in
our work environment, ready to be accessed.

``` r
library(nycflights13)

airports
```

<PRE class="fansi fansi-output"><CODE>#&gt; <span style='color: #949494;'># A tibble: 1,458 x 8</span><span>
#&gt;    faa   name                    lat    lon   alt    tz dst   tzone        
#&gt;    </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>                 </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>  </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>        
#&gt; </span><span style='color: #BCBCBC;'> 1</span><span> 04G   Lansdowne Airport      41.1  -</span><span style='color: #BB0000;'>80.6</span><span>  </span><span style='text-decoration: underline;'>1</span><span>044    -</span><span style='color: #BB0000;'>5</span><span> A     America/New_…
#&gt; </span><span style='color: #BCBCBC;'> 2</span><span> 06A   Moton Field Municipa…  32.5  -</span><span style='color: #BB0000;'>85.7</span><span>   264    -</span><span style='color: #BB0000;'>6</span><span> A     America/Chic…
#&gt; </span><span style='color: #BCBCBC;'> 3</span><span> 06C   Schaumburg Regional    42.0  -</span><span style='color: #BB0000;'>88.1</span><span>   801    -</span><span style='color: #BB0000;'>6</span><span> A     America/Chic…
#&gt; </span><span style='color: #BCBCBC;'> 4</span><span> 06N   Randall Airport        41.4  -</span><span style='color: #BB0000;'>74.4</span><span>   523    -</span><span style='color: #BB0000;'>5</span><span> A     America/New_…
#&gt; </span><span style='color: #BCBCBC;'> 5</span><span> 09J   Jekyll Island Airport  31.1  -</span><span style='color: #BB0000;'>81.4</span><span>    11    -</span><span style='color: #BB0000;'>5</span><span> A     America/New_…
#&gt; </span><span style='color: #BCBCBC;'> 6</span><span> 0A9   Elizabethton Municip…  36.4  -</span><span style='color: #BB0000;'>82.2</span><span>  </span><span style='text-decoration: underline;'>1</span><span>593    -</span><span style='color: #BB0000;'>5</span><span> A     America/New_…
#&gt; </span><span style='color: #BCBCBC;'> 7</span><span> 0G6   Williams County Airp…  41.5  -</span><span style='color: #BB0000;'>84.5</span><span>   730    -</span><span style='color: #BB0000;'>5</span><span> A     America/New_…
#&gt; </span><span style='color: #BCBCBC;'> 8</span><span> 0G7   Finger Lakes Regiona…  42.9  -</span><span style='color: #BB0000;'>76.8</span><span>   492    -</span><span style='color: #BB0000;'>5</span><span> A     America/New_…
#&gt; </span><span style='color: #BCBCBC;'> 9</span><span> 0P2   Shoestring Aviation …  39.8  -</span><span style='color: #BB0000;'>76.6</span><span>  </span><span style='text-decoration: underline;'>1</span><span>000    -</span><span style='color: #BB0000;'>5</span><span> U     America/New_…
#&gt; </span><span style='color: #BCBCBC;'>10</span><span> 0S9   Jefferson County Intl  48.1 -</span><span style='color: #BB0000;'>123.</span><span>    108    -</span><span style='color: #BB0000;'>8</span><span> A     America/Los_…
#&gt; </span><span style='color: #949494;'># … with 1,448 more rows</span><span>
</span></CODE></PRE>

Your own data will probably not be available as an R package. Whatever
format it is in, you will need to be able to load it as data frames into
your R session. If the data is too large, consider using dm to connect
to the database instead. See `vignette("howto-dm-db")` for details on
using dm with databases.

## Adding Tables

Our first step will be to tell `dm` which tables we want to work with
and how they are connected. For that we can use `dm()`, passing in the
table names as arguments.

``` r
library(dm)

flights_dm_no_keys <- dm(airlines, airports, flights, planes, weather)
flights_dm_no_keys
```

<PRE class="fansi fansi-output"><CODE>#&gt; <span style='color: #FFAFFF;'>──</span><span> </span><span style='color: #FFAFFF;'>Metadata</span><span> </span><span style='color: #FFAFFF;'>───────────────────────────────────────────────────────────────</span><span>
#&gt; Tables: `airlines`, `airports`, `flights`, `planes`, `weather`
#&gt; Columns: 53
#&gt; Primary keys: 0
#&gt; Foreign keys: 0
</span></CODE></PRE>

The `as_dm()` function is an alternative that works if you already have
a list of tables.

## A dm is a list

dm objects behave like lists with a user- and console-friendly print
format. In fact, using a dm as a nicer list for organizing your data
frames in your environment is an easy first step towards using dm and
its data modeling functionality.

Member referencing, by subscript and by name, and list and slice
manipulation functions work just as you would expect on a dm object.

``` r
names(flights_dm_no_keys)
#> [1] "airlines" "airports" "flights"  "planes"   "weather"
flights_dm_no_keys$airports
```

<PRE class="fansi fansi-output"><CODE>#&gt; <span style='color: #949494;'># A tibble: 1,458 x 8</span><span>
#&gt;    faa   name                    lat    lon   alt    tz dst   tzone        
#&gt;    </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>                 </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>  </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>        
#&gt; </span><span style='color: #BCBCBC;'> 1</span><span> 04G   Lansdowne Airport      41.1  -</span><span style='color: #BB0000;'>80.6</span><span>  </span><span style='text-decoration: underline;'>1</span><span>044    -</span><span style='color: #BB0000;'>5</span><span> A     America/New_…
#&gt; </span><span style='color: #BCBCBC;'> 2</span><span> 06A   Moton Field Municipa…  32.5  -</span><span style='color: #BB0000;'>85.7</span><span>   264    -</span><span style='color: #BB0000;'>6</span><span> A     America/Chic…
#&gt; </span><span style='color: #BCBCBC;'> 3</span><span> 06C   Schaumburg Regional    42.0  -</span><span style='color: #BB0000;'>88.1</span><span>   801    -</span><span style='color: #BB0000;'>6</span><span> A     America/Chic…
#&gt; </span><span style='color: #BCBCBC;'> 4</span><span> 06N   Randall Airport        41.4  -</span><span style='color: #BB0000;'>74.4</span><span>   523    -</span><span style='color: #BB0000;'>5</span><span> A     America/New_…
#&gt; </span><span style='color: #BCBCBC;'> 5</span><span> 09J   Jekyll Island Airport  31.1  -</span><span style='color: #BB0000;'>81.4</span><span>    11    -</span><span style='color: #BB0000;'>5</span><span> A     America/New_…
#&gt; </span><span style='color: #BCBCBC;'> 6</span><span> 0A9   Elizabethton Municip…  36.4  -</span><span style='color: #BB0000;'>82.2</span><span>  </span><span style='text-decoration: underline;'>1</span><span>593    -</span><span style='color: #BB0000;'>5</span><span> A     America/New_…
#&gt; </span><span style='color: #BCBCBC;'> 7</span><span> 0G6   Williams County Airp…  41.5  -</span><span style='color: #BB0000;'>84.5</span><span>   730    -</span><span style='color: #BB0000;'>5</span><span> A     America/New_…
#&gt; </span><span style='color: #BCBCBC;'> 8</span><span> 0G7   Finger Lakes Regiona…  42.9  -</span><span style='color: #BB0000;'>76.8</span><span>   492    -</span><span style='color: #BB0000;'>5</span><span> A     America/New_…
#&gt; </span><span style='color: #BCBCBC;'> 9</span><span> 0P2   Shoestring Aviation …  39.8  -</span><span style='color: #BB0000;'>76.6</span><span>  </span><span style='text-decoration: underline;'>1</span><span>000    -</span><span style='color: #BB0000;'>5</span><span> U     America/New_…
#&gt; </span><span style='color: #BCBCBC;'>10</span><span> 0S9   Jefferson County Intl  48.1 -</span><span style='color: #BB0000;'>123.</span><span>    108    -</span><span style='color: #BB0000;'>8</span><span> A     America/Los_…
#&gt; </span><span style='color: #949494;'># … with 1,448 more rows</span><span>
</span></CODE></PRE>

``` r
flights_dm_no_keys[c("airports", "flights")]
```

<PRE class="fansi fansi-output"><CODE>#&gt; <span style='color: #FFAFFF;'>──</span><span> </span><span style='color: #FFAFFF;'>Metadata</span><span> </span><span style='color: #FFAFFF;'>───────────────────────────────────────────────────────────────</span><span>
#&gt; Tables: `airports`, `flights`
#&gt; Columns: 27
#&gt; Primary keys: 0
#&gt; Foreign keys: 0
</span></CODE></PRE>

## Defining Keys

Even though we now have a `dm` object that contains all our data, we
have not specified how our five tables are connected. To do this we need
to define primary keys and foreign keys on the tables.

Primary keys and foreign keys are how relational database tables are
linked with each other. A primary key is a column that has a unique
value for each row within a table. A foreign key is a column containing
the primary key for a row in another table.\[1\] Foreign keys act as
cross references between tables. They specify the relationships that
gives us the *relational* database. For more information on keys and a
crash course on databases, see `vignette("howto-dm-theory")`.

## Primary Keys

`dm` offers `dm_enum_pk_candidates()` to identify viable primary keys,
and `dm_add_pk()` to add them.

``` r
dm_enum_pk_candidates(
  dm = flights_dm_no_keys,
  table = planes
)
```

<PRE class="fansi fansi-output"><CODE>#&gt; <span style='color: #949494;'># A tibble: 9 x 3</span><span>
#&gt;   columns     candidate why                                                
#&gt;   </span><span style='color: #949494;font-style: italic;'>&lt;keys&gt;</span><span>      </span><span style='color: #949494;font-style: italic;'>&lt;lgl&gt;</span><span>     </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>                                              
#&gt; </span><span style='color: #BCBCBC;'>1</span><span> tailnum     TRUE      </span><span style='color: #949494;'>""</span><span>                                                 
#&gt; </span><span style='color: #BCBCBC;'>2</span><span> engine      FALSE     </span><span style='color: #949494;'>"</span><span>has duplicate values: 4 Cycle, Reciprocating, Tur…
#&gt; </span><span style='color: #BCBCBC;'>3</span><span> engines     FALSE     </span><span style='color: #949494;'>"</span><span>has duplicate values: 1, 2, 3, 4</span><span style='color: #949494;'>"</span><span>                 
#&gt; </span><span style='color: #BCBCBC;'>4</span><span> manufactur… FALSE     </span><span style='color: #949494;'>"</span><span>has duplicate values: AIRBUS, AIRBUS INDUSTRIE, A…
#&gt; </span><span style='color: #BCBCBC;'>5</span><span> model       FALSE     </span><span style='color: #949494;'>"</span><span>has duplicate values: 717-200, 737-301, 737-3G7, …
#&gt; </span><span style='color: #BCBCBC;'>6</span><span> seats       FALSE     </span><span style='color: #949494;'>"</span><span>has duplicate values: 2, 4, 5, 6, 7, …</span><span style='color: #949494;'>"</span><span>           
#&gt; </span><span style='color: #BCBCBC;'>7</span><span> speed       FALSE     </span><span style='color: #949494;'>"</span><span>has duplicate values: 90, 105, 162, 432, NA</span><span style='color: #949494;'>"</span><span>      
#&gt; </span><span style='color: #BCBCBC;'>8</span><span> type        FALSE     </span><span style='color: #949494;'>"</span><span>has duplicate values: Fixed wing multi engine, Fi…
#&gt; </span><span style='color: #BCBCBC;'>9</span><span> year        FALSE     </span><span style='color: #949494;'>"</span><span>has duplicate values: 1959, 1963, 1975, 1976, 197…
</span></CODE></PRE>

Now, we add the primary keys that we have identified:

``` r
flights_dm_only_pks <-
  flights_dm_no_keys %>%
  dm_add_pk(table = airlines, columns = carrier) %>%
  dm_add_pk(airports, faa) %>%
  dm_add_pk(planes, tailnum)
flights_dm_only_pks
```

<PRE class="fansi fansi-output"><CODE>#&gt; <span style='color: #FFAFFF;'>──</span><span> </span><span style='color: #FFAFFF;'>Metadata</span><span> </span><span style='color: #FFAFFF;'>───────────────────────────────────────────────────────────────</span><span>
#&gt; Tables: `airlines`, `airports`, `flights`, `planes`, `weather`
#&gt; Columns: 53
#&gt; Primary keys: 3
#&gt; Foreign keys: 0
</span></CODE></PRE>

Note that we demonstrate both named and positional arguments above.

## Foreign Keys

To define how our tables are related, we use `dm_add_fk()` to add
foreign keys. In calling `dm_add_fk()` the `table` argument is the table
that needs a foreign key to link it to a second table. `ref_table` is
the table to be linked to and it needs a primary key already defined for
it.

``` r
dm_enum_fk_candidates(
  dm = flights_dm_only_pks,
  table = flights,
  ref_table = airlines
)
```

<PRE class="fansi fansi-output"><CODE>#&gt; <span style='color: #949494;'># A tibble: 19 x 3</span><span>
#&gt;    columns      candidate why                                              
#&gt;    </span><span style='color: #949494;font-style: italic;'>&lt;keys&gt;</span><span>       </span><span style='color: #949494;font-style: italic;'>&lt;lgl&gt;</span><span>     </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>                                            
#&gt; </span><span style='color: #BCBCBC;'> 1</span><span> carrier      TRUE      </span><span style='color: #949494;'>""</span><span>                                               
#&gt; </span><span style='color: #BCBCBC;'> 2</span><span> tailnum      FALSE     </span><span style='color: #949494;'>"</span><span>334264 entries (99.3%) of `flights$tailnum` not…
#&gt; </span><span style='color: #BCBCBC;'> 3</span><span> dest         FALSE     </span><span style='color: #949494;'>"</span><span>336776 entries (100%) of `flights$dest` not in …
#&gt; </span><span style='color: #BCBCBC;'> 4</span><span> origin       FALSE     </span><span style='color: #949494;'>"</span><span>336776 entries (100%) of `flights$origin` not i…
#&gt; </span><span style='color: #BCBCBC;'> 5</span><span> air_time     FALSE     </span><span style='color: #949494;'>"</span><span>Can't join on `x$value` x `y$value` because of …
#&gt; </span><span style='color: #BCBCBC;'> 6</span><span> arr_delay    FALSE     </span><span style='color: #949494;'>"</span><span>Can't join on `x$value` x `y$value` because of …
#&gt; </span><span style='color: #BCBCBC;'> 7</span><span> arr_time     FALSE     </span><span style='color: #949494;'>"</span><span>Can't join on `x$value` x `y$value` because of …
#&gt; </span><span style='color: #BCBCBC;'> 8</span><span> day          FALSE     </span><span style='color: #949494;'>"</span><span>Can't join on `x$value` x `y$value` because of …
#&gt; </span><span style='color: #BCBCBC;'> 9</span><span> dep_delay    FALSE     </span><span style='color: #949494;'>"</span><span>Can't join on `x$value` x `y$value` because of …
#&gt; </span><span style='color: #BCBCBC;'>10</span><span> dep_time     FALSE     </span><span style='color: #949494;'>"</span><span>Can't join on `x$value` x `y$value` because of …
#&gt; </span><span style='color: #BCBCBC;'>11</span><span> distance     FALSE     </span><span style='color: #949494;'>"</span><span>Can't join on `x$value` x `y$value` because of …
#&gt; </span><span style='color: #BCBCBC;'>12</span><span> flight       FALSE     </span><span style='color: #949494;'>"</span><span>Can't join on `x$value` x `y$value` because of …
#&gt; </span><span style='color: #BCBCBC;'>13</span><span> hour         FALSE     </span><span style='color: #949494;'>"</span><span>Can't join on `x$value` x `y$value` because of …
#&gt; </span><span style='color: #BCBCBC;'>14</span><span> minute       FALSE     </span><span style='color: #949494;'>"</span><span>Can't join on `x$value` x `y$value` because of …
#&gt; </span><span style='color: #BCBCBC;'>15</span><span> month        FALSE     </span><span style='color: #949494;'>"</span><span>Can't join on `x$value` x `y$value` because of …
#&gt; </span><span style='color: #BCBCBC;'>16</span><span> sched_arr_t… FALSE     </span><span style='color: #949494;'>"</span><span>Can't join on `x$value` x `y$value` because of …
#&gt; </span><span style='color: #BCBCBC;'>17</span><span> sched_dep_t… FALSE     </span><span style='color: #949494;'>"</span><span>Can't join on `x$value` x `y$value` because of …
#&gt; </span><span style='color: #BCBCBC;'>18</span><span> time_hour    FALSE     </span><span style='color: #949494;'>"</span><span>Can't join on `x$value` x `y$value` because of …
#&gt; </span><span style='color: #BCBCBC;'>19</span><span> year         FALSE     </span><span style='color: #949494;'>"</span><span>Can't join on `x$value` x `y$value` because of …
</span></CODE></PRE>

Having chosen a column from the successful candidates provided by
`dm_enum_fk_candidates()`, we use the `dm_add_fk()` function to
establish the foreign key linking the tables. In the second call to
`dm_add_fk()` we complete the process for the `flights` and `airlines`
tables that we started above. The `carrier` column in the `airlines`
table will be added as the foreign key in `flights`.

``` r
flights_dm_all_keys <-
  flights_dm_only_pks %>%
  dm_add_fk(table = flights, columns = tailnum, ref_table = planes) %>%
  dm_add_fk(flights, carrier, airlines) %>%
  dm_add_fk(flights, origin, airports)
flights_dm_all_keys
```

<PRE class="fansi fansi-output"><CODE>#&gt; <span style='color: #FFAFFF;'>──</span><span> </span><span style='color: #FFAFFF;'>Metadata</span><span> </span><span style='color: #FFAFFF;'>───────────────────────────────────────────────────────────────</span><span>
#&gt; Tables: `airlines`, `airports`, `flights`, `planes`, `weather`
#&gt; Columns: 53
#&gt; Primary keys: 3
#&gt; Foreign keys: 3
</span></CODE></PRE>

Having created the required primary and foreign keys to link all the
tables together, we now have a relational data model we can work with.

## Visualization

Visualizing a data model is a quick and easy way to verify that we have
successfully created the model we were aiming for. We can use
`dm_draw()` at any stage of the process to generate a visual
representation of the tables and the links between them:

``` r
flights_dm_no_keys %>%
  dm_draw(rankdir = "TB", view_type = "all")
```

![](/home/kirill/git/cynkra/cynkra/public/dm/vignettes/out/howto-dm-df_files/figure-gfm/unnamed-chunk-6-1.png)<!-- -->

``` r

flights_dm_no_keys %>%
  dm_add_pk(airlines, carrier) %>%
  dm_draw()
```

![](/home/kirill/git/cynkra/cynkra/public/dm/vignettes/out/howto-dm-df_files/figure-gfm/unnamed-chunk-6-2.png)<!-- -->

``` r

flights_dm_only_pks %>%
  dm_add_fk(flights, tailnum, planes) %>%
  dm_draw()
```

![](/home/kirill/git/cynkra/cynkra/public/dm/vignettes/out/howto-dm-df_files/figure-gfm/unnamed-chunk-6-3.png)<!-- -->

``` r

flights_dm_all_keys %>%
  dm_draw()
```

![](/home/kirill/git/cynkra/cynkra/public/dm/vignettes/out/howto-dm-df_files/figure-gfm/unnamed-chunk-6-4.png)<!-- -->

## Integrity Checks

As well as checking our data model visually, dm can examine the
constraints we have created by the addition of keys and verify that they
are sensible.

``` r
flights_dm_no_keys %>%
  dm_examine_constraints()
```

<PRE class="fansi fansi-message"><CODE>#&gt; <span style='color: #00BBBB;'>ℹ</span><span> No constraints defined.
</span></CODE></PRE>

``` r

flights_dm_only_pks %>%
  dm_examine_constraints()
```

<PRE class="fansi fansi-message"><CODE>#&gt; <span style='color: #00BBBB;'>ℹ</span><span> All constraints satisfied.
</span></CODE></PRE>

``` r

flights_dm_all_keys %>%
  dm_examine_constraints()
```

<PRE class="fansi fansi-message"><CODE>#&gt; <span style='color: #BBBB00;'>!</span><span> Unsatisfied constraints:
</span></CODE></PRE>

<PRE class="fansi fansi-output"><CODE>#&gt; <span style='color: #BB0000;'>●</span><span> Table `flights`: foreign key tailnum into table `planes`: 50094 entries (14.9%) of `flights$tailnum` not in `planes$tailnum`: N725MQ (575), N722MQ (513), N723MQ (507), N713MQ (483), N735MQ (396), …
</span></CODE></PRE>

The results are presented in a human-readable form, and available as a
tibble for programmatic inspection.

## Programming

Helper functions are available to access details on keys and check
results.

`dm_get_all_pks()` returns a data frame with our primary keys:

``` r
flights_dm_only_pks %>%
  dm_get_all_pks()
```

<PRE class="fansi fansi-output"><CODE>#&gt; <span style='color: #949494;'># A tibble: 3 x 2</span><span>
#&gt;   table    pk_col 
#&gt;   </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>    </span><span style='color: #949494;font-style: italic;'>&lt;keys&gt;</span><span> 
#&gt; </span><span style='color: #BCBCBC;'>1</span><span> airlines carrier
#&gt; </span><span style='color: #BCBCBC;'>2</span><span> airports faa    
#&gt; </span><span style='color: #BCBCBC;'>3</span><span> planes   tailnum
</span></CODE></PRE>

A data frame of foreign keys is retrieved with `dm_get_all_fks()`:

``` r
flights_dm_all_keys %>%
  dm_get_all_pks()
```

<PRE class="fansi fansi-output"><CODE>#&gt; <span style='color: #949494;'># A tibble: 3 x 2</span><span>
#&gt;   table    pk_col 
#&gt;   </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>    </span><span style='color: #949494;font-style: italic;'>&lt;keys&gt;</span><span> 
#&gt; </span><span style='color: #BCBCBC;'>1</span><span> airlines carrier
#&gt; </span><span style='color: #BCBCBC;'>2</span><span> airports faa    
#&gt; </span><span style='color: #BCBCBC;'>3</span><span> planes   tailnum
</span></CODE></PRE>

We can use `tibble::as_tibble()` on the result of
`dm_examine_constraints()` to programmatically inspect which constraints
are not satisfied:

``` r
flights_dm_all_keys %>%
  dm_examine_constraints() %>%
  tibble::as_tibble()
```

<PRE class="fansi fansi-output"><CODE>#&gt; <span style='color: #949494;'># A tibble: 6 x 6</span><span>
#&gt;   table   kind  columns ref_table is_key problem                           
#&gt;   </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>   </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;keys&gt;</span><span>  </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>     </span><span style='color: #949494;font-style: italic;'>&lt;lgl&gt;</span><span>  </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>                             
#&gt; </span><span style='color: #BCBCBC;'>1</span><span> flights FK    tailnum planes    FALSE  </span><span style='color: #949494;'>"</span><span>50094 entries (14.9%) of `flight…
#&gt; </span><span style='color: #BCBCBC;'>2</span><span> airlin… PK    carrier </span><span style='color: #BB0000;'>NA</span><span>        TRUE   </span><span style='color: #949494;'>""</span><span>                                
#&gt; </span><span style='color: #BCBCBC;'>3</span><span> airpor… PK    faa     </span><span style='color: #BB0000;'>NA</span><span>        TRUE   </span><span style='color: #949494;'>""</span><span>                                
#&gt; </span><span style='color: #BCBCBC;'>4</span><span> planes  PK    tailnum </span><span style='color: #BB0000;'>NA</span><span>        TRUE   </span><span style='color: #949494;'>""</span><span>                                
#&gt; </span><span style='color: #BCBCBC;'>5</span><span> flights FK    carrier airlines  TRUE   </span><span style='color: #949494;'>""</span><span>                                
#&gt; </span><span style='color: #BCBCBC;'>6</span><span> flights FK    origin  airports  TRUE   </span><span style='color: #949494;'>""</span><span>
</span></CODE></PRE>

1.  Support for compound keys (consisting of multiple columns) is
    [planned](https://github.com/krlmlr/dm/issues/3).
