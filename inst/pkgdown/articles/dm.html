<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to dm • dm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to dm">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dm</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.0.0.9008</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dm.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="dm_files/htmlwidgets-1.3/htmlwidgets.js"></script><script src="dm_files/viz-0.3/viz.js"></script><link href="dm_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="dm_files/grViz-binding-1.0.1/grViz.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to dm</h1>
            
            <h4 class="date">2019-05-10</h4>
      
      
      <div class="hidden name"><code>dm.Rmd</code></div>

    </div>

    
    
<p>The goal of both the package dm and the class <code>dm</code> - which comes along with it - is to make your life easier when you have to deal with data models the data therein.</p>
<p>Let’s first have a look at the new class:</p>
<div id="class-dm" class="section level2">
<h2 class="hasAnchor">
<a href="#class-dm" class="anchor"></a>Class <code>dm</code>
</h2>
<p>The <code>dm</code> class contains a set of tables as well as information about their primary keys and the relations between the tables. You can have your <code>dm</code>-object on different data sources, such as a local environment or a database. In the latter use case you need to have the package dbplyr installed.</p>
<p><code>dm</code> is a wrapper around two classes, which are independent from each other:</p>
<ol style="list-style-type: decimal">
<li>part of the object is a <a href="https://dplyr.tidyverse.org/reference/src.html"><code>src</code>-object</a> from dplyr</li>
<li>the other part is a class <code>data_model</code> object from the package <a href="https://github.com/bergant/datamodelr">datamodelr</a><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
</li>
</ol>
<p>The <code>src</code>-object contains the information, where the tables of your data model live. And in the <code>data_model</code> object the meta-information is stored:</p>
<ul>
<li>what are the primary keys in your schema?</li>
<li>how are the tables related to each other, i.e. what are the foreign key relations?</li>
</ul>
<p>Last but not least, a third part of the object is a named list containing the tables on the <code>src</code>.</p>
<p>So much to the theory, let’s see how to construct such an object and how it looks in <code>R</code>:</p>
</div>
<div id="ex_dm" class="section level2">
<h2 class="hasAnchor">
<a href="#ex_dm" class="anchor"></a>Examples of <code>dm</code>-objects</h2>
<p>Relevant functions for creating <code>dm</code>-objects are:</p>
<ol style="list-style-type: decimal">
<li><code><a href="../reference/dm.html">dm()</a></code></li>
<li><code><a href="../reference/dm.html">as_dm()</a></code></li>
</ol>
<p>We can use the tables from the famous package {nycflights13}:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dm)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb1-3" title="3">flights_dm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dm.html">dm</a></span>(<span class="kw"><a href="https://dplyr.tidyverse.org/reference/src_local.html">src_df</a></span>(<span class="dt">pkg =</span> <span class="st">"nycflights13"</span>))</a>
<a class="sourceLine" id="cb1-4" title="4">flights_dm</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">#&gt; ── Table source ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#&gt; src:  &lt;package: nycflights13&gt;</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt; ── Data model ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#&gt; Data model object:</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt;   5 tables:  airlines, airports, flights, planes ... </span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt;   53 columns</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt;   0 primary keys</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">#&gt;   no references</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co">#&gt; ── Rows ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co">#&gt; Total: 367687</span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="co">#&gt; airlines: 16, airports: 1458, flights: 336776, planes: 3322, weather: 26115</span></a></code></pre></div>
<p>Here we make use of the fact, that the function <code><a href="../reference/dm.html">dm(src, data_model = NULL)</a></code> includes all available tables on a source in the <code>dm</code>-object, should the <code>data_model</code>-argument be left <code>NULL</code>. Thus you can use this for example on a postgres database that you access via <code><a href="https://dplyr.tidyverse.org/reference/src_dbi.html">src_postgres()</a></code> (with the appropriate arguments <code>dbname</code>, <code>host</code>, <code>port</code>, …), to produce a <code>dm</code>-object with all the tables on the database.</p>
<p>Another way of creating a <code>dm</code>-object is calling <code><a href="../reference/dm.html">as_dm()</a></code> on a list of <code>tbls</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">iris_dm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dm.html">as_dm</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="st">"iris1"</span> =<span class="st"> </span>iris, <span class="st">"iris2"</span> =<span class="st"> </span>iris))</a>
<a class="sourceLine" id="cb2-2" title="2">iris_dm</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#&gt; ── Table source ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt; src:  &lt;environment: 0x7fab51180540&gt;</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt; ── Data model ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt; Data model object:</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt;   2 tables:  iris1, iris2 </span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt;   10 columns</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt;   0 primary keys</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt;   no references</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt; ── Rows ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt; Total: 300</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt; iris1: 150, iris2: 150</span></a></code></pre></div>
</div>
<div id="methods-for-dm-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#methods-for-dm-objects" class="anchor"></a>Methods for <code>dm</code>-objects</h2>
<p>tbl(dm, “table_name”) etc. (copy_to…) FIXME: complete</p>
<p>But how can we use dm-functions to manage primary keys of the tables in a <code>dm</code>-object?</p>
</div>
<div id="pk" class="section level2">
<h2 class="hasAnchor">
<a href="#pk" class="anchor"></a>Primary keys of <code>dm</code>-objects</h2>
<p>Useful functions for managing primary key settings are:</p>
<ol style="list-style-type: decimal">
<li><code><a href="../reference/cdm_add_pk.html">cdm_add_pk()</a></code></li>
<li><code><a href="../reference/cdm_has_pk.html">cdm_has_pk()</a></code></li>
<li><code><a href="../reference/cdm_get_pk.html">cdm_get_pk()</a></code></li>
<li><code><a href="../reference/cdm_rm_pk.html">cdm_rm_pk()</a></code></li>
<li><code><a href="../reference/cdm_check_for_pk_candidates.html">cdm_check_for_pk_candidates()</a></code></li>
</ol>
<p>As of yet <code>dm</code>-objects only support one-column primary keys. If your tables have unique compound keys, maybe consider adding a surrogate key column. If you created a <code>dm</code>-object according to the examples in <a href="#ex_dm">“Examples of <code>dm</code>-objects”</a>, your object does not yet have any primary keys set. So let’s add one. By default <code><a href="../reference/cdm_add_pk.html">cdm_add_pk()</a></code> checks if the column of the table given by the user is a unique key. Since the <code>iris</code> dataset does not have any unique one-column keys, we will use the <code>nycflights13</code> tables, i.e. <code>flights_dm</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="../reference/cdm_has_pk.html">cdm_has_pk</a></span>(flights_dm, airports)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb3-3" title="3">flights_dm_with_key &lt;-<span class="st"> </span><span class="kw"><a href="../reference/cdm_add_pk.html">cdm_add_pk</a></span>(flights_dm, airports, faa)</a>
<a class="sourceLine" id="cb3-4" title="4">flights_dm_with_key</a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; ── Table source ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; src:  &lt;package: nycflights13&gt;</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt; ── Data model ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt; Data model object:</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt;   5 tables:  airlines, airports, flights, planes ... </span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt;   53 columns</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt;   1 primary keys</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt;   no references</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt; ── Rows ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt; Total: 367687</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt; airlines: 16, airports: 1458, flights: 336776, planes: 3322, weather: 26115</span></a></code></pre></div>
<p>Still looks exactly the same as before… let’s check:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="../reference/cdm_has_pk.html">cdm_has_pk</a></span>(flights_dm_with_key, airports)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>Get the name of the column that is marked as primary key of the table:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="../reference/cdm_get_pk.html">cdm_get_pk</a></span>(flights_dm_with_key, airports)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#&gt; [1] "faa"</span></a></code></pre></div>
<p>Remove a primary key by:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw"><a href="../reference/cdm_rm_pk.html">cdm_rm_pk</a></span>(flights_dm_with_key, airports) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/cdm_has_pk.html">cdm_has_pk</a></span>(airports)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
<p>If you still need to get to know your data better, and it is already available in the form of a <code>dm</code>-object, you can use the function <code><a href="../reference/cdm_check_for_pk_candidates.html">cdm_check_for_pk_candidates()</a></code> in order to get information, which columns of a table are unique keys:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="../reference/cdm_check_for_pk_candidates.html">cdm_check_for_pk_candidates</a></span>(flights_dm_with_key, airports)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#&gt; # A tibble: 8 x 2</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#&gt;   candidate column</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt;   &lt;lgl&gt;     &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt; 1 TRUE      faa   </span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; 2 FALSE     name  </span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt; 3 FALSE     lat   </span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt; 4 TRUE      lon   </span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#&gt; 5 FALSE     alt   </span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">#&gt; 6 FALSE     tz    </span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">#&gt; 7 FALSE     dst   </span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">#&gt; 8 FALSE     tzone</span></a></code></pre></div>
<p>Table <code>flights</code> does not have any one-column primary key candidates:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw"><a href="../reference/cdm_check_for_pk_candidates.html">cdm_check_for_pk_candidates</a></span>(flights_dm_with_key, flights) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/tally.html">count</a></span>(candidate)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt; # A tibble: 1 x 2</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt;   candidate     n</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt;   &lt;lgl&gt;     &lt;int&gt;</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#&gt; 1 FALSE        19</span></a></code></pre></div>
</div>
<div id="foreign-keys" class="section level2">
<h2 class="hasAnchor">
<a href="#foreign-keys" class="anchor"></a>Foreign keys</h2>
<p>Useful functions for managing foreign key relations are:</p>
<ol style="list-style-type: decimal">
<li><code><a href="../reference/cdm_add_fk.html">cdm_add_fk()</a></code></li>
<li><code><a href="../reference/cdm_has_fk.html">cdm_has_fk()</a></code></li>
<li><code><a href="../reference/cdm_get_fk.html">cdm_get_fk()</a></code></li>
<li><code><a href="../reference/cdm_rm_fk.html">cdm_rm_fk()</a></code></li>
<li><code><a href="../reference/cdm_check_for_fk_candidates.html">cdm_check_for_fk_candidates()</a></code></li>
</ol>
<p>Now it gets (even more) interesting: we want to define relations between different tables. With the function <code><a href="../reference/cdm_add_fk.html">cdm_add_fk()</a></code> you can define, which column of which table points to another table’s column.</p>
<p>When dealing with data models, a foreign key from one table has to always point to a primary key of another table. So it has to be made sure, that the primary key of the referred table is set. You can either do that directly using <code><a href="../reference/cdm_add_pk.html">cdm_add_pk()</a></code>, or make use of the flag parameter <code>set_ref_pk</code> of the function <code><a href="../reference/cdm_add_fk.html">cdm_add_fk()</a></code>. If <code>set_ref_pk</code> is set to <code>TRUE</code> (default is <code>FALSE</code>), the column <code>ref_column</code> of the table <code>ref_table</code> will become primary key, in addition to the foreign key relation being established.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">flights_dm_with_key <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/cdm_add_fk.html">cdm_add_fk</a></span>(flights, origin, airports, faa)</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co">#&gt; ── Table source ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#&gt; src:  &lt;package: nycflights13&gt;</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#&gt; ── Data model ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">#&gt; Data model object:</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">#&gt;   5 tables:  airlines, airports, flights, planes ... </span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co">#&gt;   53 columns</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">#&gt;   1 primary keys</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">#&gt;   1 references</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">#&gt; ── Rows ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="co">#&gt; Total: 367687</span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">#&gt; airlines: 16, airports: 1458, flights: 336776, planes: 3322, weather: 26115</span></a></code></pre></div>
<p>This on the other hand will throw an error:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">flights_dm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/cdm_add_fk.html">cdm_add_fk</a></span>(flights, origin, airports, faa)</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">#&gt; 'faa' needs to be primary key of 'airports' but isn't. You can set</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">#&gt; parameter 'set_ref_pk = TRUE', or use function cdm_add_pk() to set it as</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">#&gt; primary key.</span></a></code></pre></div>
<p>Let’s create an <code>dm</code>-object with a foreign key relation to work with later on:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">flights_dm_with_fk &lt;-<span class="st"> </span><span class="kw"><a href="../reference/cdm_add_fk.html">cdm_add_fk</a></span>(flights_dm, flights, origin, airports, faa, <span class="dt">set_ref_pk =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>What if we try to add another foreign key relation from <code>flights</code> to <code>airports</code> to the object? Column <code>dest</code> might work, also pointing to <code>faa</code>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">flights_dm_with_fk <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/cdm_add_fk.html">cdm_add_fk</a></span>(flights, dest, airports, faa)</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">#&gt; Column `dest` in table `flights` contains values that are not present in</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="co">#&gt; column `faa` in table `airports`</span></a></code></pre></div>
<p>As you can see, behind the scenes, checks are executed automatically by the functions of <code>dm</code> to prevent steps that do not comply with the logic of data models.</p>
<p>Use <code><a href="../reference/cdm_has_fk.html">cdm_has_fk()</a></code> for checking if a foreign key exists, which is pointing from one table to another:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">flights_dm_with_fk <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/cdm_has_fk.html">cdm_has_fk</a></span>(flights, planes)</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb13-3" title="3">flights_dm_with_fk <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/cdm_has_fk.html">cdm_has_fk</a></span>(flights, airports)</a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>If you want to access the name of the column, which acts as a foreign key of one table to another table’s column, use <code><a href="../reference/cdm_get_fk.html">cdm_get_fk()</a></code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">flights_dm_with_fk <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/cdm_get_fk.html">cdm_get_fk</a></span>(flights, planes)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="co">#&gt; character(0)</span></a>
<a class="sourceLine" id="cb14-3" title="3">flights_dm_with_fk <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/cdm_get_fk.html">cdm_get_fk</a></span>(flights, airports)</a>
<a class="sourceLine" id="cb14-4" title="4"><span class="co">#&gt; [1] "origin"</span></a></code></pre></div>
<p>Remove foreign key relations with <code><a href="../reference/cdm_rm_fk.html">cdm_rm_fk()</a></code> (parameter <code>column = NULL</code> means removal of all relations):</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">flights_dm_with_fk <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/cdm_rm_fk.html">cdm_rm_fk</a></span>(<span class="dt">table =</span> flights, <span class="dt">column =</span> dest, <span class="dt">ref_table =</span> airports) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/cdm_get_fk.html">cdm_get_fk</a></span>(flights, airports)</a>
<a class="sourceLine" id="cb15-4" title="4"><span class="co">#&gt; The given column 'dest' is not a foreign key column of table 'flights' with</span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="co">#&gt; regards to ref_table 'airports'. Foreign key columns are: 'origin'.</span></a>
<a class="sourceLine" id="cb15-6" title="6">flights_dm_with_fk <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="st">  </span><span class="kw"><a href="../reference/cdm_rm_fk.html">cdm_rm_fk</a></span>(flights, origin, airports) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="st">  </span><span class="kw"><a href="../reference/cdm_get_fk.html">cdm_get_fk</a></span>(flights, airports)</a>
<a class="sourceLine" id="cb15-9" title="9"><span class="co">#&gt; character(0)</span></a>
<a class="sourceLine" id="cb15-10" title="10">flights_dm_with_fk <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="st">  </span><span class="kw"><a href="../reference/cdm_rm_fk.html">cdm_rm_fk</a></span>(flights, <span class="ot">NULL</span>, airports) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="st">  </span><span class="kw"><a href="../reference/cdm_get_fk.html">cdm_get_fk</a></span>(flights, airports)</a>
<a class="sourceLine" id="cb15-13" title="13"><span class="co">#&gt; character(0)</span></a></code></pre></div>
<p>Another function for getting to know your data better (cf. <code><a href="../reference/cdm_check_for_pk_candidates.html">cdm_check_for_pk_candidates()</a></code> in <a href="#pk">“Primary keys of <code>dm</code>-objects”</a>) is <code><a href="../reference/cdm_check_for_fk_candidates.html">cdm_check_for_fk_candidates()</a></code>. Use it to get an overview over foreign key candidates pointing from one table to another:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw"><a href="../reference/cdm_check_for_fk_candidates.html">cdm_check_for_fk_candidates</a></span>(flights_dm_with_key, weather, airports)</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="co">#&gt; # A tibble: 15 x 5</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co">#&gt;    candidate column     table   ref_table ref_table_pk</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co">#&gt;    &lt;lgl&gt;     &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;       </span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="co">#&gt;  1 TRUE      origin     weather airports  faa         </span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="co">#&gt;  2 FALSE     year       weather airports  faa         </span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="co">#&gt;  3 FALSE     month      weather airports  faa         </span></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="co">#&gt;  4 FALSE     day        weather airports  faa         </span></a>
<a class="sourceLine" id="cb16-9" title="9"><span class="co">#&gt;  5 FALSE     hour       weather airports  faa         </span></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="co">#&gt;  6 FALSE     temp       weather airports  faa         </span></a>
<a class="sourceLine" id="cb16-11" title="11"><span class="co">#&gt;  7 FALSE     dewp       weather airports  faa         </span></a>
<a class="sourceLine" id="cb16-12" title="12"><span class="co">#&gt;  8 FALSE     humid      weather airports  faa         </span></a>
<a class="sourceLine" id="cb16-13" title="13"><span class="co">#&gt;  9 FALSE     wind_dir   weather airports  faa         </span></a>
<a class="sourceLine" id="cb16-14" title="14"><span class="co">#&gt; 10 FALSE     wind_speed weather airports  faa         </span></a>
<a class="sourceLine" id="cb16-15" title="15"><span class="co">#&gt; 11 FALSE     wind_gust  weather airports  faa         </span></a>
<a class="sourceLine" id="cb16-16" title="16"><span class="co">#&gt; 12 FALSE     precip     weather airports  faa         </span></a>
<a class="sourceLine" id="cb16-17" title="17"><span class="co">#&gt; 13 FALSE     pressure   weather airports  faa         </span></a>
<a class="sourceLine" id="cb16-18" title="18"><span class="co">#&gt; 14 FALSE     visib      weather airports  faa         </span></a>
<a class="sourceLine" id="cb16-19" title="19"><span class="co">#&gt; 15 FALSE     time_hour  weather airports  faa</span></a></code></pre></div>
</div>
<div id="visualising-the-data-model" class="section level2">
<h2 class="hasAnchor">
<a href="#visualising-the-data-model" class="anchor"></a>Visualising the data model</h2>
<p>Relevant functions for visualising the data model:<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<ol style="list-style-type: decimal">
<li><code><a href="../reference/cdm_draw.html">cdm_set_colors()</a></code></li>
<li><code><a href="../reference/cdm_draw.html">cdm_get_colors()</a></code></li>
<li><code><a href="../reference/cdm_draw.html">cdm_get_available_colors()</a></code></li>
<li><code><a href="../reference/cdm_draw.html">cdm_draw()</a></code></li>
</ol>
<p>Once you have all primary keys set and all foreign key relations defined, it might be interesting to look at a graphical representation of your data model.</p>
<p>Let’s first create a slightly more interconnected <code>dm</code>-object from the {nycflights13} package tables:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">flights_dm_w_many_keys &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="st">  </span>flights_dm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/cdm_add_pk.html">cdm_add_pk</a></span>(planes, tailnum) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="st">  </span><span class="kw"><a href="../reference/cdm_add_pk.html">cdm_add_pk</a></span>(airports, faa) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="st">  </span><span class="kw"><a href="../reference/cdm_add_pk.html">cdm_add_pk</a></span>(airlines, carrier) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="st">  </span><span class="kw"><a href="../reference/cdm_add_fk.html">cdm_add_fk</a></span>(flights, origin, airports, faa) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="st">  </span><span class="kw"><a href="../reference/cdm_add_fk.html">cdm_add_fk</a></span>(flights, carrier, airlines, carrier) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="st">  </span><span class="kw"><a href="../reference/cdm_add_fk.html">cdm_add_fk</a></span>(flights, tailnum, planes, tailnum, <span class="dt">check =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="st">  </span><span class="kw"><a href="../reference/cdm_add_fk.html">cdm_add_fk</a></span>(flights, dest, airports, faa, <span class="dt">check =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb17-10" title="10">flights_dm_w_many_keys</a>
<a class="sourceLine" id="cb17-11" title="11"><span class="co">#&gt; ── Table source ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="co">#&gt; src:  &lt;package: nycflights13&gt;</span></a>
<a class="sourceLine" id="cb17-13" title="13"><span class="co">#&gt; ── Data model ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb17-14" title="14"><span class="co">#&gt; Data model object:</span></a>
<a class="sourceLine" id="cb17-15" title="15"><span class="co">#&gt;   5 tables:  airlines, airports, flights, planes ... </span></a>
<a class="sourceLine" id="cb17-16" title="16"><span class="co">#&gt;   53 columns</span></a>
<a class="sourceLine" id="cb17-17" title="17"><span class="co">#&gt;   3 primary keys</span></a>
<a class="sourceLine" id="cb17-18" title="18"><span class="co">#&gt;   4 references</span></a>
<a class="sourceLine" id="cb17-19" title="19"><span class="co">#&gt; ── Rows ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb17-20" title="20"><span class="co">#&gt; Total: 367687</span></a>
<a class="sourceLine" id="cb17-21" title="21"><span class="co">#&gt; airlines: 16, airports: 1458, flights: 336776, planes: 3322, weather: 26115</span></a></code></pre></div>
<p>You probably realized the option <code>check = FALSE</code> in the last two function calls when adding foreign keys. The check normally ensures, that the set of values of the column of the first table is a subset of the set of values of the primary key column of the referenced table. Since in our case this isn’t the case, but we want complexity, we turned the check off. It is recommended not to do this, since you might run into errors or other unwanted effects, mainly when working on databases.</p>
<p>You can use colors to visually group your tables into families (which could reflect their logical grouping). Currently, there are only eight different colors available (plus the option of having borders displayed around the tables or not). To find out which colors exist, use <code><a href="../reference/cdm_draw.html">cdm_get_available_colors()</a></code>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw"><a href="../reference/cdm_draw.html">cdm_get_available_colors</a></span>()</a>
<a class="sourceLine" id="cb18-2" title="2"><span class="co">#&gt; # A tibble: 15 x 3</span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="co">#&gt;    dm            datamodelr nb         </span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="co">#&gt;    &lt;chr&gt;         &lt;chr&gt;      &lt;chr&gt;      </span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="co">#&gt;  1 default       default    (border)   </span></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="co">#&gt;  2 blue_nb       accent1nb  (no border)</span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="co">#&gt;  3 orange_nb     accent2nb  (no border)</span></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="co">#&gt;  4 yellow_nb     accent3nb  (no border)</span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="co">#&gt;  5 green_nb      accent4nb  (no border)</span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="co">#&gt;  6 dark_blue_nb  accent5nb  (no border)</span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="co">#&gt;  7 light_grey_nb accent6nb  (no border)</span></a>
<a class="sourceLine" id="cb18-12" title="12"><span class="co">#&gt;  8 grey_nb       accent7nb  (no border)</span></a>
<a class="sourceLine" id="cb18-13" title="13"><span class="co">#&gt;  9 blue          accent1    (border)   </span></a>
<a class="sourceLine" id="cb18-14" title="14"><span class="co">#&gt; 10 orange        accent2    (border)   </span></a>
<a class="sourceLine" id="cb18-15" title="15"><span class="co">#&gt; 11 yellow        accent3    (border)   </span></a>
<a class="sourceLine" id="cb18-16" title="16"><span class="co">#&gt; 12 green         accent4    (border)   </span></a>
<a class="sourceLine" id="cb18-17" title="17"><span class="co">#&gt; 13 dark_blue     accent5    (border)   </span></a>
<a class="sourceLine" id="cb18-18" title="18"><span class="co">#&gt; 14 light_grey    accent6    (border)   </span></a>
<a class="sourceLine" id="cb18-19" title="19"><span class="co">#&gt; 15 grey          accent7    (border)</span></a></code></pre></div>
<p>The assignment is carried out with <code><a href="../reference/cdm_draw.html">cdm_set_colors()</a></code>, using a syntax similar to <code><a href="https://www.rdocumentation.org/packages/base/topics/switch">switch()</a></code>. Any table you don’t specifically assign will be displayed in the default color.</p>
<p>Use <code><a href="../reference/cdm_draw.html">cdm_set_colors()</a></code> to assign the respective colors. The result of <code><a href="../reference/cdm_draw.html">cdm_set_colors()</a></code> is a <code>dm</code>-object. The information about the color is stored in its <code>data_model</code>-part.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">flights_dm_w_many_keys_and_colors &lt;-</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="st">  </span>flights_dm_w_many_keys <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/cdm_draw.html">cdm_set_colors</a></span>(</a>
<a class="sourceLine" id="cb19-4" title="4">    <span class="dt">flights =</span> <span class="st">"blue"</span>,</a>
<a class="sourceLine" id="cb19-5" title="5">    <span class="dt">airlines =</span> ,</a>
<a class="sourceLine" id="cb19-6" title="6">    <span class="dt">airports =</span> <span class="st">"orange"</span>,</a>
<a class="sourceLine" id="cb19-7" title="7">    <span class="dt">planes =</span> <span class="st">"green_nb"</span></a>
<a class="sourceLine" id="cb19-8" title="8">  )</a></code></pre></div>
<p>Draw the schema with <code><a href="../reference/cdm_draw.html">cdm_draw()</a></code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw"><a href="../reference/cdm_draw.html">cdm_draw</a></span>(flights_dm_w_many_keys_and_colors)</a></code></pre></div>
<div id="htmlwidget-38c350c76b9a9875014a" style="width:700px;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-38c350c76b9a9875014a">{"x":{"diagram":"#data_model\ndigraph {\ngraph [rankdir=LR tooltip=\"Data Model\" ]\n\nnode [margin=0 fontcolor = \"#444444\" ]\n\nedge [color = \"#555555\", arrowsize = 1, ]\n\n\n  \"airlines\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#AE5A21\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#ED7D31\" BORDER=\"0\"><FONT COLOR=\"#FFFFFF\">airlines<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\" PORT=\"carrier\"><U>carrier<\/U><\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"airports\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#AE5A21\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#ED7D31\" BORDER=\"0\"><FONT COLOR=\"#FFFFFF\">airports<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\" PORT=\"faa\"><U>faa<\/U><\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"flights\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#41719C\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#5B9BD5\" BORDER=\"0\"><FONT COLOR=\"#FFFFFF\">flights<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#D6E1F1\" PORT=\"carrier\">carrier<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#D6E1F1\" PORT=\"tailnum\">tailnum<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#D6E1F1\" PORT=\"origin\">origin<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#D6E1F1\" PORT=\"dest\">dest<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"planes\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"0\" CELLBORDER=\"0\" CELLSPACING=\"0\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#70AD47\" BORDER=\"0\"><FONT COLOR=\"#FFFFFF\">planes<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#D9E6D4\" PORT=\"tailnum\"><U>tailnum<\/U><\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"weather\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">weather<\/FONT>\n<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n\"flights\":\"origin\"->\"airports\":\"faa\"\n\"flights\":\"carrier\"->\"airlines\":\"carrier\"\n\"flights\":\"tailnum\"->\"planes\":\"tailnum\"\n\"flights\":\"dest\"->\"airports\":\"faa\"\n}","config":{"engine":null,"options":null}},"evals":[],"jsHooks":[]}</script><p>The colors can be queried with <code><a href="../reference/cdm_draw.html">cdm_get_colors()</a></code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw"><a href="../reference/cdm_draw.html">cdm_get_colors</a></span>(flights_dm_w_many_keys_and_colors)</a>
<a class="sourceLine" id="cb21-2" title="2"><span class="co">#&gt; # A tibble: 5 x 2</span></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="co">#&gt;   table    color   </span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;   </span></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="co">#&gt; 1 airlines orange  </span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="co">#&gt; 2 airports orange  </span></a>
<a class="sourceLine" id="cb21-7" title="7"><span class="co">#&gt; 3 flights  blue    </span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="co">#&gt; 4 planes   green_nb</span></a>
<a class="sourceLine" id="cb21-9" title="9"><span class="co">#&gt; 5 weather  &lt;NA&gt;</span></a></code></pre></div>
<p>There are quite a few options for customization available. Please read the documentation to find out more. One argument of the function we’d like to draw your attention to, though, is <code>table_names</code>. This argument accepts a character vector with the table names which are to be printed, in case you would like to only see a subset of the whole data model.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw"><a href="../reference/cdm_draw.html">cdm_draw</a></span>(flights_dm_w_many_keys_and_colors, <span class="dt">table_names =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"flights"</span>, <span class="st">"airports"</span>, <span class="st">"planes"</span>))</a></code></pre></div>
<div id="htmlwidget-c1a4a5a77a06be9361f7" style="width:700px;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-c1a4a5a77a06be9361f7">{"x":{"diagram":"#data_model\ndigraph {\ngraph [rankdir=LR tooltip=\"Data Model\" ]\n\nnode [margin=0 fontcolor = \"#444444\" ]\n\nedge [color = \"#555555\", arrowsize = 1, ]\n\n\n  \"airports\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#AE5A21\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#ED7D31\" BORDER=\"0\"><FONT COLOR=\"#FFFFFF\">airports<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#F9DBD2\" PORT=\"faa\"><U>faa<\/U><\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"flights\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#41719C\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#5B9BD5\" BORDER=\"0\"><FONT COLOR=\"#FFFFFF\">flights<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#D6E1F1\" PORT=\"tailnum\">tailnum<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#D6E1F1\" PORT=\"origin\">origin<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#D6E1F1\" PORT=\"dest\">dest<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"planes\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"0\" CELLBORDER=\"0\" CELLSPACING=\"0\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#70AD47\" BORDER=\"0\"><FONT COLOR=\"#FFFFFF\">planes<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#D9E6D4\" PORT=\"tailnum\"><U>tailnum<\/U><\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n\"flights\":\"origin\"->\"airports\":\"faa\"\n\"flights\":\"tailnum\"->\"planes\":\"tailnum\"\n\"flights\":\"dest\"->\"airports\":\"faa\"\n}","config":{"engine":null,"options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="joining-tables" class="section level2">
<h2 class="hasAnchor">
<a href="#joining-tables" class="anchor"></a>Joining tables</h2>
</div>
<div id="filtering-a-dm-object" class="section level2">
<h2 class="hasAnchor">
<a href="#filtering-a-dm-object" class="anchor"></a>Filtering a <code>dm</code> object</h2>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Use: <code><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">devtools::install_github("https://github.com/bergant/datamodelr")</a></code> to install it<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>The functions in this section rely heavily on related functions of {datamodelr}.<a href="#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#class-dm">Class <code>dm</code></a></li>
      <li><a href="#ex_dm">Examples of <code>dm</code>-objects</a></li>
      <li><a href="#methods-for-dm-objects">Methods for <code>dm</code>-objects</a></li>
      <li><a href="#pk">Primary keys of <code>dm</code>-objects</a></li>
      <li><a href="#foreign-keys">Foreign keys</a></li>
      <li><a href="#visualising-the-data-model">Visualising the data model</a></li>
      <li><a href="#joining-tables">Joining tables</a></li>
      <li><a href="#filtering-a-dm-object">Filtering a <code>dm</code> object</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Kirill Müller, Tobias Schieferdecker.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
